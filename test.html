<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>DataHtml - Convert Excel to HTML Table</title>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<script src='https://kit.fontawesome.com/a076d05399.js' crossorigin='anonymous'></script>
<script src="https://code.jquery.com/jquery-3.3.1.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJ1SAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
<script src="https://unpkg.com/xlsx@0.15.1/dist/xlsx.full.min.js"></script>
<script type="text/javascript" src="https://unpkg.com/xlsx@0.15.1/dist/xlsx.full.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
<script src="script.js"></script>
<style>
html, body {
  margin: 0;
  padding: 0;
  width: 100%;
}

body {
  font-family: "Helvetica Neue",sans-serif;
  font-weight: lighter;
}

header {
  width: 100%;
  height: 20vh;
  background: url(https://wallpaper.wiki/wp-content/uploads/2017/05/wallpaper.wiki-Beautiful-Full-HD-Wallpaper-Download-Free-PIC-WPE0010098.jpg) no-repeat 50% 50%;
  background-size: cover;
}

/* Nav Imag */

.logo {
  line-height: 10px;
  position: fixed;
  float: left;
  margin: 16px 46px;
  color: #fff;
  font-weight: bold;
  font-family: "Helvetica Neue",sans-serif;
  fold-size: 20xp;
  letter-spacing: 2px; /* Nav Imag */
  display: flex;
  align-items: center;
}

.logo img {
  margin-left: -40px;
  height: 40px;

}

nav {
  position: fixed;
  width: 100%;
  line-height: 10px;
  background: #000f89
}

nav ul {
  line-height: 30px;
  list-style: none;
  background: rgba(0, 0, 0, 0);
  overflow: hidden;
  color: #fff;
  padding: 0;
  text-align: right;
  margin: 0;
  padding-right: 40px;
  transition: 0.1s;
  background: #000f89
}

nav ul li {
  display: inline-block;
  padding: 16px 40px;;
}

nav ul li a {
  text-decoration: none;
  color: #fff;
  font-size: 16px;
}

a {
  color: #000f89;
  text-decoration: none;
  transition: color 0.3s ease;
  
}

a:hover {
  color: #FF0000;
  
}

ul {
  list-style: none;
  padding: 0;
  opacity: 0;
  transform: translateY(20px);
  transition: opacity 0.5s ease, transform 0.5s ease;
}

.active{
  color: #FF0000 !important;
}

.menu-icon {
  line-height: 60px;
  width: 100%;
  background: #000;
  text-align: right;
  box-sizing: border-box;
  padding: 15px 24px;
  cursor: pointer;
  color: #fff;
  display: none;
}

.content {
  background-color: #ffffff;
  padding: 10px;
}

.input-group {
  display: flex;
  justify-content: center;
  align-items: center;
  margin-bottom: 20px;
}

.input-group-append {
  display: flex;
  align-items: center;
  margin-left: -10px;
}

.input-group .form-control {
  width: 700px; 
}

.btn-outline-secondary:hover { 
  background-color: #87CEFA; 
  border-color: #6c757d;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); 

}

.card {
  max-width: 100%;
  margin: 0 auto;
  margin-bottom: 20px;
}

.container-fluid { 
  padding: 100px; 
}

.table-responsive { 
  margin-top: 10px;
  padding: 0 20px;
}

.table { 
  width: 100%; 
  table-layout: fixed;
  margin: 0 auto;
}

.tableth, .tabletd { 
  text-align: left; 
  vertical-align: middle;
  padding: 30px;
  word-wrap: break-word;
  border: 1px solid #ddd;
}

@media(max-width: 786px) {

 .logo {
  position: fixed;
  top: 0;
  margin-top: 16px;
}

 nav ul {
  max-height: 0px;
  background: #000;
}

 nav.black ul {
  background: #000;
}

 .showing {
  max-height: 10em;
}

 nav ul li {
  box-sizing: border-box;
  width: 100%;
  padding: 24px;
  text-align: center;
}

 .menu-icon {
  display: block;
 
}

 .search-container {
  text-align: center;
  margin-top: 10px;
  margin-right: 0;
}
 .input-group {
  display: block;
  margin: auto;
}
}
</style>
</head>
<body>
<header>
  <nav>
   <div class="logo">
    <img src="images/logop.png" alt="NTU Badge">Department Of Social Protection</img>
   </div>
   <div class="menu-icon">
    <i class="fa fa-bars fa-2x"></i>
   </div>
    <ul id="menu">
     <li><a href="https://team/sites/ISD_TeamSite006/Shared%20Documents/ITIL/Web/index.html">Main Page <span class="glyphicon glyphicon-home"></span></a></li>
     <li><a href="https://divisions/sites/ISD/Documents/Forms/Folder%20View.aspx">Need Help <span class="glyphicon glyphicon-question-sign"></span></a></li>
     <li><a href="https://isddevcatalog/ServiceCatalog/RequestOffering/bebe62e8-6d3f-676d-4bcc-a1d791a139ab,215292d0-3682-3d72-44f5-8a04286f71ae">Log In <span class="glyphicon glyphicon-log-in"></span></a></li>
    </ul>
  </nav>
</header>

<section class="py-5">
 <div class="container">
  <h2 class="text-center mt-4 mb-4">Software Management - Excel file to Convert into HTML</h2>
  <div class="card shadow-lg border-0">
   <div class="card-header bg-primary text-white">
    <h5 class="mb-0">Select Excel File</h5>
   </div>
   <div class="card-body text-center">
    <input type="file" id="excel_file" class="form-control-file mx-auto d-block" />
   </div>
  </div>
  <br>
  <div class="input-group mb-3">
   <input type="text" id="searchInput" class="form-control" placeholder="Search for...">
   <div class="input-group-append">
    <button class="btn btn-outline-secondary" type="button" id="searchButton">Search</button>
   </div>
  </div>
  <div class="table-responsive">
   <table id="display_excel_data" class="table table-striped"></table>
  </div>
 </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
 const excel_file = document.getElementById('excel_file');
 const searchButton = document.getElementById('searchButton');

 excel_file.addEventListener('change', function(event) {
  var files = event.target.files;
  if (files.length == 0) {
   alert("No file selected.");
   return;
  }

  var file = files[0];
  var reader = new FileReader();

  reader.onload = function(event) {
   var data = event.target.result;
   var workbook = XLSX.read(data, { type: 'binary' });
   var firstSheetName = workbook.SheetNames[0];
   var jsonData = XLSX.utils.sheet_to_json(workbook.Sheets[firstSheetName]);
   displayJsonToHtmlTable(jsonData);
  };

  reader.onerror = function(event) {
   console.error("File could not be read! Code " + event.target.error.code);
  };

  reader.readAsBinaryString(file);
 });

 function displayJsonToHtmlTable(jsonData) {
  var table = document.getElementById("display_excel_data");
  if (jsonData.length > 0) {
   var htmlData = '<thead><tr><th>Software</th><th>Column3</th><th>Column2</th><th>Publisher</th><th>Total</th><th>Application Family</th><th>Highest</th><th>Average</th><th>Requires License</th><th>Current Number of Licenses</th><th>Category of Application</th><th>Is this in Snow</th><th>Snow Description Name</th></tr></thead><tbody>';
   for (var i = 0; i < jsonData.length; i++) {
    var row = jsonData[i];
    htmlData += '<tr><td>' + row["Software"] + '</td><td>' + row["Column3"] + '</td><td>' + row["Column2"] + '</td><td>' + row["Publisher"] + '</td><td>' + row["Total"] + '</td><td>' + row["Application Family"] + '</td><td>' + row["Highest"] + '</td><td>' + row["Average"] + '</td><td>' + row["Requires License"] + '</td><td>' + row["Current Number of Licenses"] + '</td><td>' + row["Category of Application"] + '</td><td>' + row["Is this in Snow"] + '</td><td>' + row["Snow Description Name"] + '</td></tr>';
   }
   htmlData += '</tbody>';
   table.innerHTML = htmlData;
  } else {
   table.innerHTML = '<thead><tr><th colspan="13">No data found</th></tr></thead>';
  }
 }
 
 searchButton.addEventListener('click', searchTable);

 function searchTable() {
  var input, filter, table, tr, td, i, txtValue;
  input = document.getElementById("searchInput");
  filter = input.value.toUpperCase();
  table = document.getElementById("display_excel_data");
  tr = table.getElementsByTagName("tr");

  for (i = 0; i < tr.length; i++) {
   td = tr[i].getElementsByTagName("td")[0]; 
   if (td) {
    txtValue = td.textContent || td.innerText;
    if (txtValue.toUpperCase().indexOf(filter) > -1) {
     tr[i].style.display = "";
    } else {
     tr[i].style.display = "none";
    }
   }
  }
 }
 });
</script>
</body>
</html>